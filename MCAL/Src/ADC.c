/**********************************************************************************************************************
 *  FILE DESCRIPTION
 *  -----------------------------------------------------------------------------------------------------------------*/
/**        \file  I2C.c
 *        \brief  This file include the functions that deliver I2C functionality
 *
 *      \details  - Initiation of ADC Based on preset options
 *                - Makes the ADC do conversion and return the result 
 *                - Sets the ISR call back function
 *
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  INCLUDES
 *********************************************************************************************************************/
#include "../../libs/Types.h"
#include "../../libs/BitMath.h"
#include "../../Libs/Registers.h"

#include "../Inc/ADC.h"
/**********************************************************************************************************************
*  LOCAL MACROS CONSTANT\FUNCTION
*********************************************************************************************************************/	

/**********************************************************************************************************************
 *  LOCAL DATA 
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL DATA
 *********************************************************************************************************************/
callBack_t (* ADC_callBack)(void) = (void*) 0;
/**********************************************************************************************************************
 *  LOCAL FUNCTION PROTOTYPES
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTIONS
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL FUNCTIONS
 *********************************************************************************************************************/
void ADC_initChanel(ADCPresc_t prescaler,ADCChannel_t channel,ADCVref_t ref,ADCInterrupt_t interrupt){
	//Choose the channel
	ADC_CHOOSE_CHANNEL(channel);
	//Set the prescaler
	ADC_SET_PRESC(prescaler);
	//Choose the reference voltage
	ADC_CHOOSE_REFERENCE(ref);
	//choose if we want to Enable the ISR
	if (interrupt == ADC_INTERRUPT_ENABLE)
	{
		ADC_ENABLE_INTERRUPT();
	}
	//Enable the ADC
	ADC_ENABLE();
}
uint16 ADC_doConversion(void){
	//Local variable to store the ADC conversion result 
    uint16 LAdc_result = 0;
	//Start the conversion
	ADC_START_CONVERSION();
	//Wait for the conversion to be done 
	ADC_WAIT_CONVERSION();
	//Return the conversion result
	ADC_RESULT(LAdc_result);
	return LAdc_result;
}

void ADC_setCallBack(callBack_t (*callBack)(void)){
	ADC_callBack = callBack;
}
/**********************************************************************************************************************
 *  END OF FILE: ADC.c
 *********************************************************************************************************************/
